(this["webpackJsonpjupiter-trading-fmcms"]=this["webpackJsonpjupiter-trading-fmcms"]||[]).push([[7],{717:function(e,t,n){"use strict";n.r(t);var c=n(15),s=n.n(c),a=n(23),r=n(165),i=n(40),l=n(12),o=n(1),u=n(22),j=n.n(u),b=n(89),d=n(681),h=n(682),m=n(163),x=n.n(m),O=n(18);t.default=function(){var e=Object(o.useContext)(b.b),t=Object(l.a)(e.UserAPI.User,1)[0],n=Object(l.a)(e.token,1)[0],c=Object(l.a)(e.MachineAPI.machines,1)[0],u=Object(o.useState)(c),m=Object(l.a)(u,2),p=m[0],f=m[1],v=Object(l.a)(e.MachineAPI.callback,2),g=v[0],w=v[1],C=Object(l.a)(e.BusinessAPI.callback,2),k=C[0],N=C[1],S=Object(l.a)(e.SalesAPI.callback,2),B=S[0],y=S[1],D=Object(o.useState)("none"),I=Object(l.a)(D,2),A=I[0],M=I[1],P=Object(o.useState)(!1),z=Object(l.a)(P,2),E=z[0],F=z[1],J=Object(o.useState)("none"),R=Object(l.a)(J,2),U=R[0],_=R[1],q=Object(o.useState)(!1),T=Object(l.a)(q,2),Y=T[0],K=T[1],L=Object(l.a)(e.BusinessAPI.businesses,1)[0],G={serialNumber:"",machineModel:"",brand:"",price:"",branch:t.branch,problemStatus:"",businessId:""},H=Object(o.useState)(G),Q=Object(l.a)(H,2),V=Q[0],W=Q[1];Object(o.useEffect)((function(){"branch-admin"===t.userRole||"technician"===t.userRole||"sales"===t.userRole?f(c.filter((function(e){return e.branch==t.branch}))):f(c)}),[t,c]);var X=function(e){var t=e.target,n=t.name,c=t.value;W(Object(i.a)(Object(i.a)({},V),{},Object(r.a)({},n,c)))},Z=function(e,t){x.a.fire({position:"center",background:"#EBEDEF",icon:e,text:t,confirmButtonColor:"#3C4B64",showConfirmButton:!0})},$=function(){var e=Object(a.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,j.a.post("/machine/register",Object(i.a)({},V));case 4:n=e.sent,Z("success",n.data.msg),F(!E),w(!g),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Z("error",e.t0.response.data.msg);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(a.a)(s.a.mark((function e(t){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,j.a.put("/machine/edit/".concat(A),Object(i.a)({},V),{headers:{Authorization:n}});case 4:c=e.sent,Z("success",c.data.msg),F(!E),w(!g),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Z("error",e.t0.response.data.msg);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(a.a)(s.a.mark((function e(t,c){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{x.a.fire({title:"Delete?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3C4B64",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(){var e=Object(a.a)(s.a.mark((function e(c){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.isConfirmed){e.next=6;break}return e.next=3,j.a.delete("/machine/delete/".concat(t),{headers:{Authorization:n}});case 3:a=e.sent,x.a.fire("Deleted!",a.data.msg,"success"),w(!g);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(c){Z("error",c.response.data.msg)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ne=function(){var e=Object(a.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,j.a.post("/machine/distribute",Object(i.a)(Object(i.a)({},V),{},{machineId:U}));case 4:n=e.sent,Z("success",n.data.msg),K(!Y),w(!g),N(!k),y(!B),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Z("error",e.t0.response.data.msg);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(a.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{x.a.fire({title:"Undistribute Machine?",text:"You are about to undstribute machine from a busines!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3C4B64",cancelButtonColor:"#d33",confirmButtonText:"Yes, Undistribute it!"}).then(function(){var e=Object(a.a)(s.a.mark((function e(c){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.isConfirmed){e.next=7;break}return e.next=3,j.a.put("/machine/undistribute/".concat(t),{headers:{Authorization:n}});case 3:a=e.sent,x.a.fire("Undistributed!",a.data.msg,"success"),w(!g),N(!k);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(c){Z("error",c.response.data.msg)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)(d.h,{className:" shadow-sm",children:[Object(O.jsxs)(d.k,{className:"d-flex justify-content-between",children:[Object(O.jsx)(d.I,{children:"Jupiter all machine list"}),"branch-admin"===t.userRole&&Object(O.jsxs)(d.e,{size:"sm",color:"dark",onClick:function(){M("none"),W(Object(i.a)({machine:V},G)),F(!E)},children:[Object(O.jsx)(h.a,{name:"cil-plus"})," Add Machine"]})]}),Object(O.jsx)(d.i,{children:Object(O.jsx)(d.o,{items:p,fields:["serialNumber","machineModel","brand","price","salesStatus","problemStatus",{key:"Actions",label:"Actions",sorter:!1,filter:!1}],tableFilter:!0,columnFilter:!0,itemsPerPageSelect:!0,itemsPerPage:10,hover:!0,cleaner:!0,sorter:!0,pagination:!0,scopedSlots:{salesStatus:function(e){return Object(O.jsxs)("td",{className:"d-flex justify-content-between",children:[e.salesStatus,"sales"===t.userRole&&Object(O.jsx)(O.Fragment,{children:"unsold"===e.salesStatus?Object(O.jsx)(d.J,{className:"text-primary",onClick:function(){_(e._id),K(!Y)},children:Object(O.jsx)(d.jb,{content:"Distribut - ".concat(e.serialNumber,"- machine."),children:Object(O.jsx)(h.a,{name:"cil-control"})})}):"returning"===e.salesStatus?Object(O.jsx)(d.J,{className:"text-success",onClick:function(){_(e._id),ce(e._id)},children:Object(O.jsx)(d.jb,{content:"Revert - ".concat(e.serialNumber,"- machine."),children:Object(O.jsx)(h.a,{name:"cil-loop"})})}):""})]})},Actions:function(e){return Object(O.jsxs)("td",{className:"d-flex justify-content-between",children:["branch-admin"===t.userRole&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(d.J,{className:"text-success",onClick:function(){W(Object(i.a)({machine:e},e)),M(e._id),F(!E)},children:Object(O.jsx)(d.jb,{content:"Edit the  - ".concat(e.serialNumber,"- machine detail."),children:Object(O.jsx)(h.a,{name:"cil-pencil"})})}),"sold"!==e.salesStatus&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("span",{className:"text-muted",children:"|"}),Object(O.jsx)(d.J,{className:"text-danger",onClick:function(){return te(e._id)},children:Object(O.jsx)(d.jb,{content:"Delete - ".concat(e.serialNumber,"- machine."),children:Object(O.jsx)(h.a,{name:"cil-trash"})})})]}),Object(O.jsx)("span",{className:"text-muted",children:"|"})]}),Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(d.J,{className:"text-info",onClick:function(){},children:Object(O.jsx)(d.jb,{content:"See detail of  - ".concat(e.serialNumber,"- machine."),children:Object(O.jsx)(h.a,{name:"cil-align-center"})})})})]})}}})}),Object(O.jsxs)(d.K,{size:"lg",show:E,onClose:function(){return F(!E)},children:[Object(O.jsx)(d.N,{closeButton:!0,children:Object(O.jsx)(d.O,{className:"text-muted",children:"Open-New-machine"})}),Object(O.jsxs)(d.v,{onSubmit:$,children:[Object(O.jsx)(d.L,{children:Object(O.jsxs)(d.T,{children:[Object(O.jsx)(d.l,{xs:"12",md:"6",children:Object(O.jsxs)(d.w,{children:["Serial Number",Object(O.jsx)(d.D,{id:"serialNumber",name:"serialNumber",placeholder:"Enter serial number.",value:V.serialNumber,onChange:X,required:!0})]})}),Object(O.jsx)(d.l,{xs:"12",md:"6",children:Object(O.jsxs)(d.w,{children:["Model",Object(O.jsx)(d.D,{id:"machineModel",name:"machineModel",placeholder:"Enter machine model.",value:V.machineModel,onChange:X,required:!0})]})}),Object(O.jsx)(d.l,{xs:"12",md:"4",children:Object(O.jsxs)(d.w,{children:["Brand",Object(O.jsx)(d.D,{id:"brand",name:"brand",placeholder:"Enter brand.",value:V.brand,onChange:X})]})}),Object(O.jsx)(d.l,{xs:"12",md:"4",children:Object(O.jsxs)(d.w,{children:["Price",Object(O.jsx)(d.D,{id:"price",name:"price",placeholder:"Enter price.",value:V.price,onChange:X,required:!0})]})}),Object(O.jsx)(d.l,{xs:"12",md:"4",children:Object(O.jsxs)(d.w,{children:["Machine status",Object(O.jsxs)(d.U,{"aria-label":"Default select example",id:"problemStatus",name:"problemStatus",onChange:X,value:V.problemStatus,required:!0,children:[Object(O.jsx)("option",{value:"",children:"Select machine status..."}),Object(O.jsx)("option",{value:"fine",children:"Fine"}),Object(O.jsx)("option",{value:"damaged",children:"Damaged"})]})]})})]})}),Object(O.jsxs)(d.M,{children:["none"===A?Object(O.jsxs)(d.e,{type:"submit",size:"sm",color:"dark",children:[Object(O.jsx)(h.a,{name:"cil-save"})," Register machine"]}):Object(O.jsxs)(d.e,{size:"sm",color:"dark",onClick:ee,children:[Object(O.jsx)(h.a,{name:"cil-pencil"})," Save Changes"]}),Object(O.jsxs)(d.e,{size:"sm",color:"danger",onClick:function(){return F(!E)},children:[Object(O.jsx)(h.a,{name:"cil-x"})," Close"]})]})]})]}),Object(O.jsxs)(d.K,{show:Y,onClose:function(){return F(!Y)},children:[Object(O.jsx)(d.N,{closeButton:!0,children:Object(O.jsx)(d.O,{className:"text-muted",children:"Distribute-machine"})}),Object(O.jsxs)(d.v,{onSubmit:ne,children:[Object(O.jsx)(d.L,{children:Object(O.jsxs)(d.T,{children:[Object(O.jsx)(d.l,{md:"6",children:Object(O.jsxs)(d.w,{children:["Machine Id",Object(O.jsx)(d.U,{"aria-label":"Default select example",id:"machineId",name:"machineId",onChange:X,required:!0,children:Object(O.jsx)("option",{value:U,children:U})})]})}),Object(O.jsx)(d.l,{md:"6",children:Object(O.jsxs)(d.w,{children:["To wich business",Object(O.jsxs)(d.U,{"aria-label":"Default select example",id:"businessId",name:"businessId",onChange:X,value:V.businessId,required:!0,children:[Object(O.jsx)("option",{value:"",children:"Select business..."}),L.filter((function(e){return"unassigned"===e.machine&&"Accepted"===e.credentials&&e.branch==t.branch})).map((function(e){return Object(O.jsx)("option",{value:e._id,children:e.businessName},e._id)}))]}),Object(O.jsx)("small",{className:"text-muted",children:"If the business is not in the list it may be assigned a mchine or not registered yet!"})]})})]})}),Object(O.jsxs)(d.M,{children:[Object(O.jsxs)(d.e,{type:"submit",size:"sm",color:"dark",children:[Object(O.jsx)(h.a,{name:"cil-control"})," Distribute"]}),Object(O.jsxs)(d.e,{size:"sm",color:"danger",onClick:function(){return K(!Y)},children:[Object(O.jsx)(h.a,{name:"cil-x"})," Close"]})]})]})]})]})})}}}]);
//# sourceMappingURL=7.31be0893.chunk.js.map