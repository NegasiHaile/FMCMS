(this["webpackJsonpjupiter-trading-fmcms"]=this["webpackJsonpjupiter-trading-fmcms"]||[]).push([[3],{718:function(e,s,t){"use strict";t.r(s);var c=t(17),n=t.n(c),a=t(24),r=t(168),i=t(42),j=t(13),l=t(1),b=t(23),d=t.n(b),o=t(90),h=t(22),u=t(685),m=t(165),x=t.n(m),O=t(684),f=t(11);s.default=function(){var e=Object(l.useContext)(o.b),s=Object(h.h)(),t=Object(j.a)(e.UserAPI.User,1)[0],c=Object(j.a)(e.BusinessAPI.businesses,1)[0],b=Object(l.useState)(""),m=Object(j.a)(b,2),p=m[0],g=m[1],N=Object(j.a)(e.branchAPI.branchs,1)[0],w=Object(j.a)(e.UsersAPI.users,2),y=w[0],v=(w[1],Object(j.a)(e.SalesAPI.Sales,1)[0]),C=Object(l.useState)(v),I=Object(j.a)(C,2),k=I[0],A=I[1],B=Object(j.a)(e.MachineAPI.callback,2),S=B[0],R=B[1],T=Object(j.a)(e.BusinessAPI.callback,2),_=T[0],P=T[1],M=Object(j.a)(e.SalesAPI.callback,2),z=M[0],E=M[1],D=Object(j.a)(e.MachineAPI.machines,1)[0],F=Object(l.useState)(""),q=Object(j.a)(F,2),Q=(q[0],q[1],Object(l.useState)(!1)),U=Object(j.a)(Q,2),J=U[0],K=U[1],L=Object(l.useState)({senderId:t._id,receiverId:"",subject:"Rejection",theMessage:""}),V=Object(j.a)(L,2),W=V[0],Y=V[1],G=Object(l.useState)(!1),H=Object(j.a)(G,2),X=H[0],Z=H[1],$=Object(l.useState)({branch:t.branch,businessId:s.id,machineId:"",status:""}),ee=Object(j.a)($,2),se=ee[0],te=ee[1];Object(l.useEffect)((function(){if(s.id){var e=c.filter((function(e){return e._id===s.id}));g(e[0]),Y({senderId:t._id,receiverId:e[0].ownerID,subject:"Rejection",theMessage:""});var n=v.filter((function(e){return e.businessId===s.id}));A(n)}else g(""),A("")}),[c,v,s.id]);var ce=function(e,s){x.a.fire({position:"center",background:"#EBEDEF",icon:e,text:s,confirmButtonColor:"#1E263C",showConfirmButton:!1})},ne=function(){var e=Object(a.a)(n.a.mark((function e(s){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,d.a.put("/business/reject/".concat(p._id),Object(i.a)({},W));case 4:t=e.sent,P(!_),K(!J),ce("success",t.data.msg),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),ce("error",e.t0.response.data.msg);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(s){return e.apply(this,arguments)}}(),ae=function(){var e=Object(a.a)(n.a.mark((function e(s){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,d.a.post("/machine/distribute",Object(i.a)({},se));case 4:t=e.sent,R(!S),P(!_),E(!z),ce("success",t.data.msg),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),ce("error",e.t0.response.data.msg);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(s){return e.apply(this,arguments)}}();return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(O.h,{children:[Object(f.jsxs)(O.i,{children:[Object(f.jsxs)(O.T,{className:"mb-2",children:[Object(f.jsx)(O.l,{sm:"12",md:"3",className:"d-flex justify-content-center",children:Object(f.jsx)(O.C,{className:"shadow-sm ",height:"150",src:"/Others/bsnsIcon1.png",alt:"Business Img"})}),Object(f.jsxs)(O.l,{sm:"6",md:"6",className:"mt-1",children:[Object(f.jsx)("h6",{}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"Businss Name:"})," ",p.businessName]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"Company Name:"})," ",p.companyName]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"TIN:"})," ",p.TIN]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"VAT:"})," ",p.VAT]})]}),Object(f.jsxs)(O.l,{sm:"6",md:"3",className:"mt-1",children:[Object(f.jsx)("h6",{}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"Machine:"})," ",p.machine]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"Credentials:"})," ",p.credentials]}),"branch-admin"===t.userRole&&Object(f.jsxs)(f.Fragment,{children:[" ","Pending"===p.credentials&&Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsxs)(O.e,{color:"dark",size:"sm",className:"mr-1 w-50",onClick:function(){!function(e){try{x.a.fire({title:"Accepte?",text:"Is the overall document is valid and you can assign it a machine!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#1E263C",cancelButtonColor:"#d33",confirmButtonText:"Yes, Accepte it!"}).then(function(){var s=Object(a.a)(n.a.mark((function s(t){var c;return n.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!t.isConfirmed){s.next=6;break}return s.next=3,d.a.put("/business/accepte/".concat(e));case 3:c=s.sent,P(!_),x.a.fire("Accepted!",c.data.msg,"success");case 6:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}())}catch(s){ce("error",s.response.data.msg)}}(p._id)},children:[Object(f.jsx)(u.a,{name:"cil-check-circle"})," Accept"]}),Object(f.jsxs)(O.e,{onClick:function(){K(!J)},color:"danger",size:"sm",className:"ml-1 w-50",children:[Object(f.jsx)(u.a,{name:"cil-x"})," Reject"]})]})]}),"sales"===t.userRole&&"Accepted"===p.credentials&&"unassigned"===p.machine&&Object(f.jsx)(O.e,{onClick:function(){Z(!X)},color:"dark",size:"sm",className:"w-100",children:"Assigne Machine"})]})]}),Object(f.jsxs)(O.gb,{children:[Object(f.jsxs)(O.P,{variant:"tabs",children:[Object(f.jsx)(O.Q,{children:Object(f.jsxs)(O.R,{children:[Object(f.jsx)(u.a,{name:"cil-location-pin"})," Address"]})}),Object(f.jsx)(O.Q,{children:Object(f.jsxs)(O.R,{children:[Object(f.jsx)(u.a,{name:"cil-options"})," References"]})}),Object(f.jsx)(O.Q,{children:Object(f.jsxs)(O.R,{children:[Object(f.jsx)(u.a,{name:"cil-spreadsheet"})," license"]})}),Object(f.jsx)(O.Q,{children:Object(f.jsxs)(O.R,{children:[Object(f.jsx)(u.a,{name:"cil-memory"})," Certificates"]})})]}),Object(f.jsxs)(O.eb,{className:"my-3",children:[Object(f.jsx)(O.fb,{children:Object(f.jsxs)(O.T,{children:[Object(f.jsxs)(O.l,{sm:"12",md:"6",lg:"5",className:"mt-1",children:[Object(f.jsx)("h6",{children:"Business Address"}),Object(f.jsx)("hr",{}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"City:"})," ",p.city]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Sub City:"})," ",p.subCity]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Kebele:"})," ",p.kebele]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Woreda:"})," ",p.woreda]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Building Name:"})," ",p.buildingName]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Office Number:"})," ",p.officeNumber]})]}),Object(f.jsxs)(O.l,{sm:"6",md:"6",lg:"5",className:"mt-1",children:[Object(f.jsx)("h6",{children:"Business Contacts"}),Object(f.jsx)("hr",{})," ",Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Telephone:"}),p.telephone]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Email:"})," ",p.email]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Fax:"})," ",p.fax]})]})]})}),Object(f.jsx)(O.fb,{children:Object(f.jsxs)(O.T,{children:[Object(f.jsxs)(O.l,{sm:"12",md:"4",lg:"3",className:"mt-1",children:[Object(f.jsx)("h6",{className:"text-muted",children:"Business Owner"}),Object(f.jsx)("hr",{}),y.filter((function(e){return e._id===p.ownerID})).map((function(e){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Owner name:"})," ",Object(f.jsxs)(O.J,{to:"/client/detail/".concat(e._id),children:[e.fName," ",e.mName]})]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Phone:"})," ",e.phoneNumber]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"email:"})," ",e.email]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Account Status:"})," ",e.status]})]},e._id)}))]}),Object(f.jsxs)(O.l,{sm:"12",md:"4",lg:"3",className:"mt-1",children:[Object(f.jsx)("h6",{className:"text-muted",children:"Machine Detail"}),Object(f.jsx)("hr",{}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Machine:"})," ",p.machine]}),0!==k.length&&Object(f.jsxs)(f.Fragment,{children:[k.map((function(e){return Object(f.jsxs)("div",{children:["assigned"===p.machine&&("client"===t.userRole||"sales"===t.userRole)&&Object(f.jsx)(O.e,{variant:"ghost",color:"danger",size:"sm",className:"w-100 mt-3",to:"/business/return-machine/".concat(e.saleId),children:"Request to return this machine"}),"returning"===p.machine&&"branch-admin"===t.userRole&&Object(f.jsx)(O.e,{variant:"ghost",color:"success",size:"sm",className:"w-100 mt-3",children:"Confirm Return"})]},e.saleId)}))," "]})]}),Object(f.jsxs)(O.l,{sm:"12",md:"4",lg:"3",className:"mt-1",children:[Object(f.jsx)("h6",{className:"text-muted",children:"Technician Detail"}),Object(f.jsx)("hr",{}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Technician:"})," ",p.sw_Tech]})]}),Object(f.jsxs)(O.l,{sm:"12",md:"4",lg:"3",className:"mt-1",children:[Object(f.jsx)("h6",{className:"text-muted",children:"Branch"}),Object(f.jsx)("hr",{}),N.filter((function(e){return e._id===p.branch})).map((function(e){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Branch Name:"})," ",e.branchName]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"City:"})," ",e.city]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Telephone:"})," ",e.telephone]}),Object(f.jsxs)("span",{className:"d-flex justify-content-between",children:[Object(f.jsx)("strong",{children:"Email:"})," ",e.email]})]},e._id)}))]})]})}),Object(f.jsx)(O.fb,{children:Object(f.jsx)(O.C,{className:"w-100",src:p.TL_Image,alt:p.businessName})})]})]})]}),Object(f.jsx)(O.K,{show:J,onClose:function(){return K(!J)},children:Object(f.jsx)(O.L,{children:Object(f.jsxs)(O.v,{onSubmit:ne,children:[Object(f.jsxs)(O.l,{children:[Object(f.jsx)(O.I,{htmlFor:"textarea-input",children:"Your message"}),Object(f.jsx)(O.hb,{id:"theMessage",name:"theMessage",onChange:function(e){var s=e.target,t=s.name,c=s.value;Y(Object(i.a)(Object(i.a)({},W),{},Object(r.a)({},t,c)))},rows:"4",placeholder:"Write something why you are rejecting this request...",required:!0})]}),Object(f.jsxs)(O.l,{className:"d-flex justify-content-between pt-2",children:[Object(f.jsxs)(O.e,{type:"submit",size:"sm",variant:"outline",color:"dark",children:[Object(f.jsx)(u.a,{name:"cil-check-circle"})," confirm Rejection"]}),Object(f.jsxs)(O.e,{size:"sm",variant:"outline",color:"danger",onClick:function(){return K(!J)},children:[Object(f.jsx)(u.a,{name:"cil-x"})," Close"]})]})]})})}),Object(f.jsx)(O.K,{show:X,onClose:function(){return Z(!X)},children:Object(f.jsxs)(O.v,{onSubmit:ae,className:"m-2",children:[Object(f.jsx)(O.l,{children:Object(f.jsxs)(O.w,{children:[Object(f.jsx)(O.I,{children:"Machine you want to assigne to this business"}),Object(f.jsxs)(O.U,{"aria-label":"Default select example",id:"machineId",value:se.machineId,onChange:function(e){te(Object(i.a)(Object(i.a)({},se),{},{machineId:e.target.value}))},required:!0,children:[Object(f.jsx)("option",{value:"",children:"Select machine ..."}),D.filter((function(e){return("unsold"===e.salesStatus||"returned"===e.salesStatus)&&e.branch==t.branch})).map((function(e){return Object(f.jsxs)("option",{value:e._id,children:["SER NO: ",e.serialNumber," - Brand:"," ",e.brand]},e._id)}))]})]})}),Object(f.jsxs)(O.l,{className:"d-flex justify-content-between mt-1",children:[Object(f.jsxs)(O.e,{type:"submit",size:"sm",variant:"outline",color:"dark",children:[Object(f.jsx)(u.a,{name:"cil-check-circle"})," Confirm"]}),Object(f.jsxs)(O.e,{size:"sm",variant:"outline",color:"danger",onClick:function(){return Z(!X)},children:[Object(f.jsx)(u.a,{name:"cil-x"})," Close"]})]})]})})]})})}}}]);
//# sourceMappingURL=3.136a3eed.chunk.js.map